# ISIC 2019 Dataset Segmentation using Canny and GVF

This repository contains Python code to segment images in the ISIC 2019 dataset, specifically for the "mel" and "nevus" subcategories. The segmentation is performed using a combination of Canny Edge Detection and Gradient Vector Flow (GVF) to refine edge maps. The output includes refined edge maps saved for each processed image.

## Table of Contents
- [Dataset Structure](#dataset-structure)
- [Requirements](#requirements)
- [Workflow](#workflow)
- [Code Explanation](#code-explanation)
- [Usage](#usage)
- [Results](#results)

## Dataset Structure
Place the ISIC 2019 dataset in a folder named `dataset` with the following structure:
```
dataset/
├── mel/
│   ├── image1.jpg
│   ├── image2.jpg
│   └── ...
└── nevus/
    ├── image1.jpg
    ├── image2.jpg
    └── ...
```

## Requirements
Install the required libraries before running the code:
```bash
pip install opencv-python-headless numpy scipy matplotlib pyqt5
```

## Workflow
The workflow for edge detection and segmentation is as follows:
1. **Gaussian Blur**: Apply Gaussian blur to reduce noise in the input image.
2. **Canny Edge Detection**: Detect edges in the blurred image using the Canny algorithm with adjustable thresholds.
3. **Morphological Operations**: Use morphological closing and opening to fill gaps in edges for better continuity.
4. **Gradient Vector Flow (GVF)**: Calculate a GVF-like field based on the Canny edges to create a smooth vector field.
5. **Edge Refinement**: Refine the edges using the GVF field to obtain a smooth, connected edge map.

## Code Explanation

The code is organized into several parts:

- **Parameter Definitions**: Set parameters for Gaussian blur (`sigma`), Canny thresholds (`canny_threshold1` and `canny_threshold2`), and GVF iterations (`gvf_iterations`).
- **apply_gvf Function**: Computes GVF-like smoothing on the gradient field of the Canny edges.
- **process_image Function**: Applies the complete pipeline (blur, Canny, morphology, GVF) to a single image and saves the output.
- **Main Loop**: Iterates through all images in the `mel` and `nevus` folders, processing and saving the results.

## Usage

Run the script using Python:

```bash
python segmentation_script.py
```

This will process all images in the `dataset/mel` and `dataset/nevus` folders, saving output images to the `output` folder.

### Output
For each processed image, the following files are saved in a dedicated output folder:
- `cannyEdge_<i>.jpg`: The edge map generated by Canny Edge Detection.
- `gvf_<i>.jpg`: The refined edge map generated by applying GVF.

The output folder structure will look like this:
```
output/
├── result_0/
│   ├── cannyEdge_0.jpg
│   ├── gvf_0.jpg
├── result_1/
│   ├── cannyEdge_1.jpg
│   ├── gvf_1.jpg
└── ...
```

## Results

The edge refinement aims to create smooth and continuous edges in medical images, making it easier for downstream processing, such as segmentation and classification.

## License
This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.

---

This README should provide a clear overview of your project, its structure, and usage instructions. Let me know if you want to add more details!
